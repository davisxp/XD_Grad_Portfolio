<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Documents — XD Finance Portfolio</title>
  <meta name="description" content="Documents: valuation thesis, memos and supporting files" />
  <style>
    /* Theme & layout derived from index.html for consistent site styling */
    :root{
      --navy: #001f3f;
      --navy-light: #003d7a;
      --text: #1a1a1a;
      --text-muted: #666;
      --border: #ddd;
      --bg-light: #f8f9fa;
      --max-width: 1000px;
      --accent: #17664b;
      --panel-bg: #fff;
      --muted:#4a4a4a;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      color:var(--text);
      background:#fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Top nav (same style as index) */
    .top-nav {
      position: sticky;
      top: 0;
      z-index: 40;
      background: var(--navy);
      color: #fff;
      padding: 12px 20px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      border-bottom:2px solid var(--navy);
    }
    .logo { font-weight:600; color:#fff; font-size:16px }
    .nav-links { display:inline-flex; gap:10px; align-items:center }
    .btn {
      display:inline-block;
      padding:8px 12px;
      border:1px solid rgba(255,255,255,0.15);
      background:transparent;
      color:inherit;
      border-radius:8px;
      font-weight:500;
      text-decoration:none;
      cursor:pointer;
    }
    .btn.primary {
      background: #fff;
      color: var(--navy);
      border-color: #fff;
    }
    .btn.secondary {
      border-color: rgba(255,255,255,0.25);
      color: #fff;
      background: transparent;
    }

    /* Page shell */
    main{
      max-width: var(--max-width);
      margin: 28px auto;
      padding: 0 20px 80px;
    }
    header.page-head {
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:18px;
    }
    header.page-head h1 { margin:0; font-size:20px; color:var(--navy) }
    .lead { color:var(--text-muted); margin-top:6px; font-size:14px }

    /* Documents layout (left list, right viewer) */
    .grid {
      display:grid;
      grid-template-columns:320px 1fr;
      gap:18px;
      align-items:start;
    }
    .panel {
      background:var(--panel-bg);
      border:1px solid var(--border);
      border-radius:10px;
      padding:12px;
    }
    .doc-list { display:flex; flex-direction:column; gap:10px }
    .doc-item {
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px;
      border-radius:8px;
      transition:background .12s, border-color .12s;
      border:1px solid transparent;
    }
    .doc-item:hover {
      background: var(--bg-light);
      border-color:var(--border);
    }
    .doc-meta { color:var(--muted); font-size:13px }
    .doc-title { font-weight:600; color:var(--navy) }

    .viewer-controls {
      display:flex;
      gap:8px;
      align-items:center;
      margin-bottom:10px;
    }
    .spacer { flex:1 }

    .iframe-wrap {
      border-radius:8px;
      overflow:hidden;
      border:1px solid var(--border);
      background:#fff;
      min-height:240px;
    }
    iframe { width:100%; height:640px; border:0; display:block; }

    .small { font-size:13px; color:var(--muted) }

    /* responsive */
    @media (max-width:980px){
      .grid { grid-template-columns: 1fr; }
      iframe { height:520px; }
    }
  </style>
</head>
<body>
  <div class="top-nav" role="navigation" aria-label="Top navigation">
    <div style="display:flex;gap:12px;align-items:center">
      <div class="logo">XD Finance Portfolio</div>
    </div>

    <nav class="nav-links" aria-label="Main links">
      <a class="btn secondary" href="./">Landing</a>
      <a class="btn" href="viewer/">Open Live Viewer</a>
      <a class="btn primary" href="/XD_Grad_Portfolio/documents.html">Documents</a>
      <a class="btn" href="https://github.com/davisxp/XD_Grad_Portfolio" target="_blank" rel="noopener">GitHub</a>
    </nav>
  </div>

  <main>
    <header class="page-head">
      <div>
        <h1>Documents</h1>
        <div class="lead">Embedded PDFs and DOCX for your portfolio. Preview or open in Office Viewer.</div>
      </div>
      <div class="spacer"></div>
      <div>
        <a class="btn" href="./">Back to landing page</a>
        <a class="btn primary" href="https://github.com/davisxp/XD_Grad_Portfolio" target="_blank" rel="noopener">Manage files</a>
      </div>
    </header>

    <div class="grid" role="main">
      <aside class="panel" aria-labelledby="availableDocs">
        <h2 id="availableDocs" style="margin:0 0 8px 0">Available documents</h2>
        <div class="doc-list" id="docList">
          <!-- populated by JS -->
        </div>
        <div class="small" style="margin-top:10px">
        </div>
      </aside>

      <section class="panel" aria-live="polite">
        <div class="viewer-controls">
          <div id="activeInfo" class="doc-meta">No document selected</div>
          <div class="spacer"></div>
          <button class="btn" id="closeBtn" disabled>Close</button>
          <a class="btn primary" id="openOffice" target="_blank" rel="noopener">Open in Office Viewer</a>
        </div>

        <div class="iframe-wrap" id="iframeWrap" style="display:none">
          <iframe id="docFrame" src="" title="Document viewer"></iframe>
        </div>

        <div id="notes" class="small" style="margin-top:10px"></div>
      </section>
    </div>
  </main>

  <script>
    /* Documents list - update to match files in your repo */
    const DOCUMENTS = [
      { id:'valuation', title:'Valuation Thesis (PDF)', path:'docs/Test.pdf', type:'pdf', date:'2025-11-01' }
    ];

    const docList = document.getElementById('docList');
    const docFrame = document.getElementById('docFrame');
    const iframeWrap = document.getElementById('iframeWrap');
    const activeInfo = document.getElementById('activeInfo');
    const closeBtn = document.getElementById('closeBtn');
    const openOfficeBtn = document.getElementById('openOffice');
    const notesEl = document.getElementById('notes');

    // Build the list UI
    function buildList(){
      docList.innerHTML = '';
      DOCUMENTS.forEach(doc=>{
        const row = document.createElement('div');
        row.className = 'doc-item';

        const left = document.createElement('div');
        left.style.maxWidth = '72%';
        left.innerHTML = `<div class="doc-title">${escapeHtml(doc.title)}</div>
                          <div class="doc-meta">${doc.date} • ${doc.type.toUpperCase()}</div>`;

        const right = document.createElement('div');
        right.style.display = 'flex';
        right.style.gap = '8px';

        const previewBtn = document.createElement('button');
        previewBtn.className = 'btn';
        previewBtn.textContent = 'Preview';
        previewBtn.addEventListener('click', ()=> previewDocument(doc));

        const openBtn = document.createElement('button');
        openBtn.className = 'btn primary';
        openBtn.textContent = 'Open';
        openBtn.addEventListener('click', ()=> openDocument(doc));

        right.appendChild(previewBtn);
        right.appendChild(openBtn);

        row.appendChild(left);
        row.appendChild(right);
        docList.appendChild(row);
      });
      docList.setAttribute('aria-label', 'Document list. ' + DOCUMENTS.length + ' items found.');
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]; });
    }

    function openDocument(doc){
      if(doc.type === 'pdf'){
        // open raw pdf in new tab
        window.open(doc.path, '_blank', 'noopener');
      } else {
        // open via Office viewer for docx
        const office = officeEmbedURL(new URL(doc.path, location.href).href);
        window.open(office, '_blank', 'noopener');
      }
    }

    function previewDocument(doc){
      notesEl.textContent = '';
      if(doc.type === 'pdf'){
        docFrame.src = doc.path + '?t=' + Date.now();
        iframeWrap.style.display = 'block';
        activeInfo.textContent = doc.title + ' • Preview';
        closeBtn.disabled = false;
        openOfficeBtn.href = officeEmbedURL(new URL(doc.path, location.href).href) + '&wdDownloadButton=TRUE';
        // scroll into view on small screens
        iframeWrap.scrollIntoView({behavior:'smooth', block:'center'});
      } else if(doc.type === 'docx'){
        // Prefer Office Viewer inline for docx; if blocked, user can open
        const officeURL = officeEmbedURL(new URL(doc.path, location.href).href) + '&wdDownloadButton=TRUE';
        docFrame.src = officeURL;
        iframeWrap.style.display = 'block';
        activeInfo.textContent = doc.title + ' • Preview (Office Viewer)';
        closeBtn.disabled = false;
        openOfficeBtn.href = officeURL;
        notesEl.textContent = 'If the inline preview does not render, use Open to download or view in Office Viewer.';
      } else {
        activeInfo.textContent = doc.title + ' • Unsupported';
        notesEl.textContent = 'This file type cannot be previewed inline. Use Open to download.';
      }
    }

    function officeEmbedURL(absFileURL){
      return 'https://view.officeapps.live.com/op/embed.aspx?src=' + encodeURIComponent(absFileURL);
    }

    closeBtn.addEventListener('click', ()=>{
      docFrame.src = '';
      iframeWrap.style.display = 'none';
      activeInfo.textContent = 'No document selected';
      closeBtn.disabled = true;
      notesEl.textContent = '';
    });

    // Esc to close
    document.addEventListener('keydown', e => { if(e.key === 'Escape') closeBtn.click(); });

    // Initialize
    buildList();
  </script>
</body>
</html>
